\documentclass[11pt,a4paper,openany]{book}
\usepackage[a4paper,margin=2cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{lmodern}
\renewcommand{\familydefault}{\sfdefault}

\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage[unicode,pdfencoding=auto,hypertexnames=false]{hyperref}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{pdflscape}
\usepackage{array}
\usepackage{siunitx}
\DeclareSIUnit{\MeV}{MeV}
\DeclareSIUnit{\GeV}{GeV}
\DeclareSIUnit{\eV}{eV}
\DeclareSIUnit{\squared}{\ensuremath{^2}}
\usepackage{fancyhdr}
\usepackage{float}
\usepackage{tikz}
\usepackage[most,skins,hooks]{tcolorbox}
\tcbset{colback=white,colframe=black,arc=2pt,boxrule=0.5pt,before upper={\parindent0pt}}
% Allow floats inside tcolorbox using minipage trick
\newtcolorbox{tcboxfloat}[1][]{%
  enhanced,
  before upper=\parindent0pt,
  #1
}
\tikzset{
  t0blue/.style={draw=blue,fill=blue!10},
  t0red/.style={draw=red,fill=red!10},
  t0green/.style={draw=green!50!black,fill=green!10},
  t0orange/.style={draw=orange,fill=orange!10},
}
\usepackage{setspace}
\usepackage{enumitem}
\usepackage{adjustbox}
\usepackage{xcolor}
\usepackage{colortbl}
\usepackage{listings}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{truncate}

% Define header title width for truncation
\newlength{\headertitlewidth}
\setlength{\headertitlewidth}{60mm}

% Configure listings for Python code with line breaking
\lstset{
  language=Python,
  basicstyle=\ttfamily\footnotesize,
  breaklines=true,
  breakatwhitespace=true,
  postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
  numbers=left,
  numberstyle=\tiny\color{gray},
  frame=single,
  tabsize=4,
  showstringspaces=false,
  keywordstyle=\color{blue},
  commentstyle=\color{green!50!black},
  stringstyle=\color{red},
  xleftmargin=0pt,
  xrightmargin=0pt,
  columns=flexible
}

% Define colors for xcolor package
\definecolor{t0green}{RGB}{34,139,34}
\definecolor{t0blue}{RGB}{0,0,255}
\definecolor{t0red}{RGB}{255,0,0}
\definecolor{t0orange}{RGB}{255,165,0}

% Define custom column types for tables
\newcolumntype{L}[1]{>{\raggedright\arraybackslash}p{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}p{#1}}

\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt}

\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  citecolor=blue,
  urlcolor=blue
}
\pagestyle{fancy}
\setlength{\headheight}{28pt}

% Header and Footer Configuration for Books
\fancyhf{} % Clear all headers/footers
\fancyhead[L]{\textsc{J. Pascher}}
\fancyhead[R]{\nouppercase{\leftmark}}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

% Redefine chapter/section marks to truncate long titles
\renewcommand{\chaptermark}[1]{%
  \markboth{\thechapter.\ \truncate{60mm}{#1}}{}%
}
\renewcommand{\sectionmark}[1]{%
  \markright{\thesection.\ \truncate{60mm}{#1}}%
}

% Provide truncate if not available
\usepackage{truncate}

\newcommand{\checkmarkx}{\checkmark}
\newcommand{\warningx}{\textbf{!}}

% Makros aus Einzel-Dokumenten (Fallback-Definitionen)
\newcommand{\mytimes}{\times}
\newcommand{\myapprox}{\approx}
\newcommand{\mysim}{\sim}
\newcommand{\myomega}{\omega}
\newcommand{\mypi}{\pi}
\newcommand{\myrightarrow}{\rightarrow}
\newcommand{\mypropto}{\propto}
\newcommand{\deltafield}{\delta\phi}
\newcommand{\xipar}{\xi}
\newcommand{\xiT}{\xi}
\newcommand{\lambdah}{\lambda_h}

% Additional macros used in chapter files
\newcommand{\Kfrak}{K_{\text{frak}}}  % Fractal correction factor
\newcommand{\Dfrak}{D_f}              % Fractal dimension
\newcommand{\betapar}{\beta}          % T0 beta parameter
\newcommand{\alphapar}{\alpha}        % T0 alpha parameter
\newcommand{\Efield}{E}               % Energy field
% Note: checkmarkxa/warningxa are variants used in auto-generated chapter files
\newcommand{\checkmarkxa}{\checkmark}
\newcommand{\warningxa}{\textbf{!}}

% Additional T0-specific macros
\newcommand{\xigeom}{\xi_{\text{geom}}}  % Geometric xi
\newcommand{\lP}{\ell_P}                  % Planck length
\newcommand{\rzero}{r_0}                  % Characteristic radius
\newcommand{\xirat}{\xi_{\text{rat}}}     % Xi ratio
\newcommand{\tzero}{t_0}                  % Characteristic time
\newcommand{\natunits}{\text{(nat. units)}}  % Natural units annotation
\newcommand{\myRightarrow}{\Rightarrow}   % Arrow variant
\newcommand{\Lag}{\mathcal{L}}            % Lagrangian

% Physics macros used in chapter files
\newcommand{\CQCD}{C_{\text{QCD}}}        % QCD correction
\newcommand{\EP}{E_P}                     % Planck energy
\newcommand{\Ee}{E_e}                     % Electron energy
\newcommand{\Emu}{E_\mu}                  % Muon energy
\newcommand{\Exi}{E_\xi}                  % Xi energy
\newcommand{\Ezero}{E_0}                  % Characteristic energy
\newcommand{\Hubble}{H}                   % Hubble constant
\newcommand{\Kspec}{K_{\text{spec}}}      % Spectral correction
\newcommand{\Lambdat}{\Lambda_t}          % Time-related cosmological constant
\newcommand{\Leff}{\mathcal{L}_{\text{eff}}}  % Effective Lagrangian
\newcommand{\Lorentz}{\mathcal{L}}        % Lorentz symbol
\newcommand{\Lxi}{L_\xi}                  % Xi length
\newcommand{\Tfield}{T}                   % Time field
\newcommand{\Weyl}{W}                     % Weyl tensor/symbol
\newcommand{\alphaEMSI}{\alpha_{\text{EM,SI}}}  % EM alpha in SI
\newcommand{\alphaEMnat}{\alpha_{\text{EM,nat}}}  % EM alpha in natural units
\newcommand{\alphaem}{\alpha_{\text{em}}} % Electromagnetic alpha
\newcommand{\betaTSI}{\beta_{T,\text{SI}}}  % Beta in SI
\newcommand{\betaTnat}{\beta_{T,\text{nat}}}  % Beta in natural units
\newcommand{\deltam}{\delta m}            % Mass difference
\newcommand{\phiT}{\phi_T}                % T-field phi
\newcommand{\tP}{t_P}                     % Planck time
\newcommand{\rhoCMB}{\rho_{\text{CMB}}}   % CMB density
\newcommand{\rhoCasimir}{\rho_{\text{Casimir}}}  % Casimir density

% Table formatting
\usepackage{multirow}

% Additional physics macros
\newcommand{\Riem}{\mathcal{R}}           % Riemann tensor
\newcommand{\ZPinch}{Z_{\text{pinch}}}    % Z-pinch
\newcommand{\SynchPower}{P_{\text{synch}}} % Synchrotron power
\newcommand{\Rzero}{R_0}                  % Characteristic radius
\newcommand{\alphafine}{\alpha}           % Fine structure constant
\newcommand{\Etau}{E_\tau}                % Tau energy
\newcommand{\deltaE}{\delta E}            % Energy deviation
\newcommand{\EPlanck}{E_P}                % Planck energy
\newcommand{\pichar}{\pi}                 % Pi character
\newcommand{\alphaWSI}{\alpha_{W,\text{SI}}}  % Wien alpha in SI
\newcommand{\alphaWnat}{\alpha_{W,\text{nat}}}  % Wien alpha in natural units

% T0 field and energy variants
\newcommand{\Tfieldt}{T(t)}               % Time field as function of t
\newcommand{\Echar}{E_{\text{char}}}      % Characteristic energy
\newcommand{\Lzero}{L_0}                  % Characteristic length
\newcommand{\Tzero}{T_0}                  % Characteristic time (T0 reference)
\newcommand{\Evis}{E_{\text{vis}}}        % Visible energy
\newcommand{\Phiphoton}{\phi_\gamma}      % Photon field
\newcommand{\Cconv}{C_{\text{conv}}}      % Conversion constant
\newcommand{\Lp}{\ell_P}                  % Planck length variant
\newcommand{\Cto}{C_{T0}}                 % T0 coupling constant
\newcommand{\DhiggsT}{\mathcal{D}_{H,T}}  % Higgs-T derivative
\newcommand{\Df}{D_f}                     % Fractal dimension (alternate)

% Einfache abstract-Umgebung f√ºr Kapitel:
\newenvironment{abstract}{%
  \begin{center}\bfseries Abstract\end{center}\small
}{\par}

% Tcolorbox environments used in German documents (T0-Theory-vs-Synergetics etc.)
% Using 'breakable' to allow floats and page breaks
\newtcolorbox{vergleich}{enhanced,breakable,colback=blue!5!white, colframe=blue!75!black, title={Comparison}}
\newtcolorbox{vorteil}{enhanced,breakable,colback=green!5!white, colframe=green!75!black, title={T0 Advantage}}
\newtcolorbox{gemeinsam}{enhanced,breakable,colback=orange!5!white, colframe=orange!75!black, title={Common Ground}}
\newtcolorbox{highlight}{enhanced,breakable,colback=yellow!10!white, colframe=yellow!75!black, title={Highlight}}

% Additional tcolorbox environment that can contain floats
% Using minipage workaround for figure/table inside boxes
\newenvironment{floatbox}[1][]{%
  \begin{tcolorbox}[enhanced,breakable,#1]%
  \begin{minipage}{\linewidth}%
}{%
  \end{minipage}%
  \end{tcolorbox}%
}
